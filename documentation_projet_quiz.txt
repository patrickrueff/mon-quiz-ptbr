
# Documentation du Projet Quiz Portugais Brésilien

## 1. Vue d'ensemble

Ce projet génère un ensemble de pages HTML permettant :
- La navigation dans un dictionnaire / ensemble de leçons (pages leçons)
- L'accès à un quiz global ou spécifique à une leçon
- La visualisation des mots avec audio, phonétique et traduction
- Le lancement d'un quiz interactif avec suivi du score

Les données sources sont stockées en JSON et incluent :
- La liste des mots (`pt`, `fr`, `phon`, fichiers audio)
- L'index des leçons et leurs contenus (références aux mots)

Les scripts Python produisent **des pages HTML statiques** avec CSS et JS embarqués,
utilisables sans serveur web.

---

## 2. Structure des fichiers Python

### 01_main.py
- Point d'entrée principal.
- Charge dynamiquement tous les modules nécessaires (`assets`, `utils`, `pages_*`).
- Construit les pages :
  - Index
  - Pages leçons
  - Pages quiz global et par leçon
- Utilise `global_manifest` (liste des mots) et `lessons_index` (liste des leçons).

### 02_assets_base_css.py
- Fournit le CSS de base via `get_base_css()`.
- Style commun à toutes les pages (mise en page, boutons, cartes...)

### 03_assets_base_js_common.py
- Fournit le JavaScript commun via `get_base_js_common()`.
- Fonctions utilitaires JS : gestion audio, filtrage des cartes, mode quiz visuel.

### 04_assets_quiz_js.py
- Génère le code JavaScript du quiz avec `make_quiz_js(timer_seconds, auto_delay_ms)`.
- Gère :
  - Démarrage / pause / reprise
  - Tirage aléatoire des questions (`makeQuiz` et `shuffle`)
  - Construction des choix (`buildChoices`)
  - Affichage du compte à rebours
  - Évaluation des réponses et score
  - Passage automatique à la question suivante
- Paramètres :
  - `timer_seconds` : durée limite par question
  - `auto_delay_ms` : délai avant question suivante

### 05_utils_load_json.py
- Fournit `load_json(path)` pour lire un fichier JSON avec encodage UTF-8.

### 06_utils_write_html.py
- Fournit `write_html(out_path, title, subtitle, body_html, extra_js="", home_link=True)`.
- Assemble une page HTML complète :
  - En-tête HTML avec CSS de base
  - Corps fourni (`body_html`)
  - JavaScript commun et spécifique (`extra_js`)
  - Pied de page et lecteur audio

### 07_utils_build_word_card.py
- Fournit `build_word_card(idx, pt, fr, phon, file_normal, file_slow="")`.
- Construit une carte HTML pour un mot :
  - Affiche portugais (`pt`), phonétique (`phon`), français (`fr`)
  - Boutons audio (normal, lent)

### 08_pages_build_index.py
- Construit la page `index.html` :
  - Carte "Résumé" avec nombre de leçons et mots
  - Liste des leçons avec liens vers leçon et quiz
  - Liste complète de tous les mots (cartes)
- Utilise `build_word_card` et `write_html`.

### 09_pages_build_lesson_pages.py
- Génère une page HTML par leçon.
- Chargement robuste des utilitaires (gestion de noms de fichiers avec chiffre initial).
- Intègre la phonétique via la clé `"phon"` comme les leçons.
- Structure :
  - Titre, barre de recherche, bascule "mode quiz"
  - Grille de cartes de mots de la leçon
  - Lien vers le quiz de la leçon

### 10_pages_to_quiz_pool_js.py
- Fournit `to_quiz_pool_js(words_list)` :
  - Transforme une liste de mots en tableau JSON utilisable par le quiz JS (`POOL`).
  - Garde : `pt`, `fr`, `phon`, `normal` (fichier audio).
  - Exclut les mots sans audio normal.

### 11_pages_build_quiz_page.py
- Fournit `build_quiz_page(out_path, title, subtitle, pool_js_array, quiz_js, timer_seconds)`.
- Génère la structure HTML d'un quiz :
  - Paramètres (nombre de questions)
  - Zone de jeu avec score, timer, boutons, choix
- Intègre le tableau `POOL` et le JS du quiz.

### 12_pages_build_quiz_pages.py
- Fournit `build_quiz_pages(root, out_dir, lessons_index, global_manifest, quiz_js, timer_seconds=8)`.
- Génère :
  - Quiz global (`quiz.html`) avec tous les mots
  - Quiz par leçon (`quiz-<id>.html`)
- Utilise `to_quiz_pool_js` et `build_quiz_page`.

---

## 3. Flux de génération

1. **Chargement des données** (`global_manifest.json`, `lessons_index.json`).
2. **Génération CSS & JS communs** via `get_base_css()` et `get_base_js_common()`.
3. **Pages générées** :
   - `index.html` → avec `build_index`
   - `lesson-<id>.html` → avec `build_lesson_pages`
   - `quiz.html` et `quiz-<id>.html` → avec `build_quiz_pages`
4. **Inclusion du JS du quiz** construit par `make_quiz_js()`.

---

## 4. Gestion de la phonétique
- La clé `"phon"` est lue dans `global_manifest["words"]`.
- Les leçons (`build_lesson_pages`) et le quiz (`to_quiz_pool_js`) passent cette valeur aux pages HTML.
- Affichée entre crochets `[...]` si disponible.

---

## 5. Points personnalisables
- Durée du timer (`timer_seconds`)
- Délai avant prochaine question (`auto_delay_ms`)
- Présence ou non de la phonétique
- Sélection aléatoire des questions
- Mode global ou par leçon

---
